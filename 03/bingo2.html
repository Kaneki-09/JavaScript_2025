<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BingoMachine</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/the-new-css-reset/css/reset.min.css" />
</head>
<style>
    body {
        font-family: 'Segoe UI', Arial, sans-serif;
        background: linear-gradient(135deg, #e0eafc 0%, #cfdef3 100%);
        min-height: 100vh;
    }

    .wrapper {
        width: 650px;
        margin: 40px auto;
        text-align: center;
        background: #fff;
        border-radius: 18px;
        box-shadow: 0 6px 24px rgba(0, 0, 0, 0.12);
        padding: 32px 24px 28px 24px;
    }

    .btn {
        display: flex;
        justify-content: space-around;
        margin-bottom: 28px;
    }

    .btn button {
        padding: 12px 28px;
        font-size: 18px;
        background: linear-gradient(90deg, #007bff 60%, #00c6ff 100%);
        color: #fff;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        margin-top: 0;
        font-weight: bold;
        box-shadow: 0 2px 8px rgba(0, 123, 255, 0.08);
        transition: background 0.2s, transform 0.2s;
    }

    .btn button:hover {
        background: linear-gradient(90deg, #0056b3 60%, #00aaff 100%);
        transform: translateY(-2px) scale(1.04);
    }

    .result {
        font-size: 64px;
        margin-bottom: 18px;
        color: #007bff;
        font-weight: bold;
        letter-spacing: 2px;
        text-shadow: 0 2px 8px rgba(0, 123, 255, 0.10);
        min-height: 70px;
    }

    .history {
        font-size: 22px;
        color: #555;
        margin-bottom: 10px;
        min-height: 32px;
        word-break: break-all;
    }

    .remaining {
        font-size: 22px;
        color: #28a745;
        font-weight: bold;
        margin-top: 10px;
        letter-spacing: 1px;
    }

    /* Add a nice animation for the result */
    .result.animate {
        animation: pop 0.3s;
    }

    @keyframes pop {
        0% {
            transform: scale(1);
        }

        60% {
            transform: scale(1.25);
        }

        100% {
            transform: scale(1);
        }
    }

    .bingo-table-container {
        margin-top: 24px;
        display: flex;
        justify-content: center;
        background: #e3f2fd;
        border-radius: 12px;
        box-shadow: 0 4px 16px rgba(0, 123, 255, 0.07);
        padding: 18px 10px 10px 10px;
    }

    .bingo-table {
        border-collapse: separate;
        border-spacing: 6px;
        background: transparent;
        box-shadow: none;
    }

    .bingo-table td {
        width: 48px;
        height: 48px;
        text-align: center;
        font-size: 22px;
        border-radius: 50%;
        border: 2px solid #b3c6e0;
        background: #fff;
        color: #333;
        font-weight: 500;
        box-shadow: 0 2px 8px rgba(0, 123, 255, 0.04);
        transition: background 0.2s, color 0.2s, border 0.2s, box-shadow 0.2s;
        position: relative;
    }

    .bingo-table td.drawn {
        background: linear-gradient(135deg, #007bff 60%, #00c6ff 100%);
        color: #fff;
        font-weight: bold;
        border: 2.5px solid #007bff;
        box-shadow: 0 0 16px #007bff55;
        animation: pop 0.3s;
    }

    .bingo-table td:not(.drawn):hover {
        background: #e3f2fd;
        border: 2.5px solid #00c6ff;
        cursor: pointer;
        color: #007bff;
        box-shadow: 0 0 8px #00c6ff33;
    }

    .bingo-table td:empty {
        background: transparent;
        border: none;
        box-shadow: none;
    }
</style>

<body>
    <div class="wrapper">
        <div class="btn">
            <button class="start">START</button>
            <button class="stop">STOP</button>
            <button class="reset">RESET</button>
        </div>
        <p class="result">?</p>
        <p class="history"></p>
        <p class="remaining">Remaining: 10</p>
        <div class="bingo-table-container">
            <table class="bingo-table">
                <tbody>
                    <!-- Table rows will be generated by JS -->
                </tbody>
            </table>
        </div>
    </div>
    <script>
        const startBtn = document.querySelector(".start");
        const stopBtn = document.querySelector(".stop");
        const resetBtn = document.querySelector(".reset");
        const resultEl = document.querySelector(".result");
        const historyEl = document.querySelector(".history");
        const remainingEl = document.querySelector(".remaining");

        const numbers = [];
        let randomNumbers = [];
        let historyNumbers = [];
        const minNumber = 1; // Start from 1
        const total = 75; // Only 15 numbers will be drawn
        let isRunning = false;
        let currentIndex = 0;
        let timerId = null;

        for (let i = minNumber; i <= total; i++) {
            numbers.push(i);
        }
        const shuffle = (array) => {
            for (let i = array.length - 1; i > 0; i--) {
                let j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        };

        randomNumbers = shuffle([...numbers]);
        let resetState = () => {
            isRunning = false;
            currentIndex = 0;
            clearInterval(timerId);
            randomNumbers = shuffle([...numbers]);
            historyNumbers = [];
            resultEl.textContent = "?";
            historyEl.textContent = "";
            remainingEl.textContent = `Remaining: ${randomNumbers.length}`;
        };

        const startRandom = () => {
            if (!isRunning && randomNumbers.length > 0) {
                isRunning = true;
                clearInterval(timerId);
                resultEl.style.background = '#e3f2fd';
                resultEl.style.color = '#007bff';
                timerId = setInterval(() => {
                    // Only show numbers that haven't been drawn yet
                    if (randomNumbers.length > 0) {
                        currentIndex = (currentIndex + 1) % randomNumbers.length;
                        resultEl.textContent = randomNumbers[currentIndex];
                        resultEl.classList.add('animate');
                        setTimeout(() => resultEl.classList.remove('animate'), 250);
                    }
                }, 30);
            }
        };

        let stopRandom = () => {
            if (isRunning) {
                isRunning = false;
                clearInterval(timerId);
                // Draw the selected number and remove it from randomNumbers
                let selected;
                if (randomNumbers.length > 0) {
                    selected = randomNumbers.splice(currentIndex, 1)[0];
                }
                if (selected !== undefined) {
                    historyNumbers.push(selected);
                }
                historyEl.textContent = historyNumbers.join(", ");
                remainingEl.textContent = `Remaining: ${randomNumbers.length}`;
                // Reset currentIndex to 0 if there are still numbers left, otherwise leave as is
                if (randomNumbers.length > 0) {
                    currentIndex = 0;
                }
                resultEl.style.background = '#d4edda';
                resultEl.style.color = '#28a745';
                if (randomNumbers.length === 0) {
                    resultEl.textContent = "Bingo! All numbers drawn!";
                    resultEl.style.background = '#ffe082';
                    resultEl.style.color = '#ff6f00';
                } else if (selected !== undefined) {
                    // Show the last drawn number
                    resultEl.textContent = selected;
                }
            }
        };

        function renderBingoTable() {
            const tableBody = document.querySelector('.bingo-table tbody');
            tableBody.innerHTML = '';
            let cols = 10;
            let rows = Math.ceil(numbers.length / cols);
            let idx = 0;
            for (let r = 0; r < rows; r++) {
                const tr = document.createElement('tr');
                for (let c = 0; c < cols; c++) {
                    const td = document.createElement('td');
                    if (idx < numbers.length) {
                        const num = numbers[idx];
                        td.textContent = num;
                        td.className = historyNumbers.includes(num) ? 'drawn' : '';
                        td.setAttribute('data-num', num);
                        idx++;
                    } else {
                        td.textContent = '';
                    }
                    tr.appendChild(td);
                }
                tableBody.appendChild(tr);
            }
        }

        function updateBingoTable() {
            document.querySelectorAll('.bingo-table td').forEach(td => {
                const num = Number(td.getAttribute('data-num'));
                if (historyNumbers.includes(num)) {
                    td.classList.add('drawn');
                } else {
                    td.classList.remove('drawn');
                }
            });
        }

        const originalResetState = resetState;
        resetState = function () {
            originalResetState();
            renderBingoTable();
        };

        const originalStopRandom = stopRandom;
        stopRandom = function () {
            originalStopRandom();
            updateBingoTable();
        };

        renderBingoTable();

        startBtn.addEventListener("click", startRandom);
        stopBtn.addEventListener("click", stopRandom);
        resetBtn.addEventListener("click", resetState);
        resetState();
    </script>
</body>

</html>